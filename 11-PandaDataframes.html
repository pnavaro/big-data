
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pandas Dataframes &#8212; Python tools for Big data</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://pnavaro.github.io/big-data/11-PandaDataframes.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic Commands in the Unix Shell" href="12-UnixCommands.html" />
    <link rel="prev" title="Pandas Series" href="10-PandasSeries.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://pnavaro.github.io/big-data/11-PandaDataframes.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Pandas Dataframes" />
<meta property="og:description" content="Pandas Dataframes  %matplotlib inline %config InlineBackend.figure_format = &#39;retina&#39; import pandas as pd import numpy as np import matplotlib.pyplot as plt  pd." />
<meta property="og:image"       content="https://pnavaro.github.io/big-data/_static/logoR2-Noir.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logoR2-Noir.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python tools for Big data</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-GitBasics.html">
   Git basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-Installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-JupyterQuickStart.html">
   Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-WordCount.html">
   Wordcount
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-MapReduce.html">
   Map Reduce
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-ParallelComputation.html">
   Parallel Computation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-AsynchronousProcessing.html">
   Asynchronous Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-DaskDelayed.html">
   Dask
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-DaskBag.html">
   Dask bag
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10-PandasSeries.html">
   Pandas Series
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Pandas Dataframes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-UnixCommands.html">
   Basic Commands in the Unix Shell
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Hadoop.html">
   Hadoop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-FileFormats.html">
   File Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-PySpark.html">
   PySpark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-DaskDataframes.html">
   Dask Dataframes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-SparkDataFrames.html">
   Spark DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18-NYCTaxiCabTripDask.html">
   Dask dataframes on HDFS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19-NYCTaxiCabTripSpark.html">
   Spark dataframes on HDFS
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/11-PandaDataframes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/pnavaro/big-data"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/pnavaro/big-data/issues/new?title=Issue%20on%20page%20%2F11-PandaDataframes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/pnavaro/big-data/edit/master/notebooks/11-PandaDataframes.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pnavaro/big-data/master?urlpath=tree/notebooks/11-PandaDataframes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/pnavaro/big-data/blob/master/notebooks/11-PandaDataframes.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-dataframe">
   Create a DataFrame
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-data-from-csv-file">
   Load Data from CSV File
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-data">
   Viewing Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index">
   Index
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-rename-dataframe-months-in-english">
     Exercise: Rename DataFrame Months in English
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#from-a-local-or-remote-html-file">
   From a local or remote HTML file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indexing-on-dataframes">
   Indexing on DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#masking">
   Masking
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#new-column">
   New column
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modifying-a-dataframe-with-multiple-indexing">
   Modifying a dataframe with multiple indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transforming-datasets">
   Transforming datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply">
   Apply
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sort">
   Sort
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stack-and-unstack">
   Stack and unstack
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transpose">
   Transpose
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#describing">
   Describing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-aggregation-summarization">
   Data Aggregation/summarization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#groupby">
   groupby
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise">
     Exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pandas-dataframes">
<h1>Pandas Dataframes<a class="headerlink" href="#pandas-dataframes" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;retina&#39;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-dataframe">
<h2>Create a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe">DataFrame</a><a class="headerlink" href="#create-a-dataframe" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>2.600151</td>
      <td>0.132765</td>
      <td>1.707829</td>
      <td>-0.295911</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>-2.798453</td>
      <td>1.746394</td>
      <td>-0.352617</td>
      <td>0.418689</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.358990</td>
      <td>-1.091402</td>
      <td>-0.343609</td>
      <td>0.781971</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.050239</td>
      <td>0.183915</td>
      <td>0.527889</td>
      <td>-0.689375</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>1.106096</td>
      <td>-1.017711</td>
      <td>0.385552</td>
      <td>-0.405261</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-0.422660</td>
      <td>0.877695</td>
      <td>-0.643301</td>
      <td>-0.884874</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>
              <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20130102&#39;</span><span class="p">),</span>
              <span class="s1">&#39;C&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
              <span class="s1">&#39;D&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">),</span>
              <span class="s1">&#39;E&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;train&quot;</span><span class="p">,</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;train&quot;</span><span class="p">]),</span>
              <span class="s1">&#39;F&#39;</span> <span class="p">:</span> <span class="s1">&#39;foo&#39;</span> <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>0</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>1</td>
      <td>train</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>2</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="load-data-from-csv-file">
<h2>Load Data from CSV File<a class="headerlink" href="#load-data-from-csv-file" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.fun-mooc.fr/c4x/agrocampusouest/40001S03/asset/AnaDo_JeuDonnees_TemperatFrance.csv&quot;</span>
<span class="n">french_cities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Janv</th>
      <th>Févr</th>
      <th>Mars</th>
      <th>Avri</th>
      <th>Mai</th>
      <th>Juin</th>
      <th>juil</th>
      <th>Août</th>
      <th>Sept</th>
      <th>Octo</th>
      <th>Nove</th>
      <th>Déce</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Moye</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="viewing-data">
<h2>Viewing Data<a class="headerlink" href="#viewing-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Janv</th>
      <th>Févr</th>
      <th>Mars</th>
      <th>Avri</th>
      <th>Mai</th>
      <th>Juin</th>
      <th>juil</th>
      <th>Août</th>
      <th>Sept</th>
      <th>Octo</th>
      <th>Nove</th>
      <th>Déce</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Moye</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Lille</th>
      <td>2.4</td>
      <td>2.9</td>
      <td>6.0</td>
      <td>8.9</td>
      <td>12.4</td>
      <td>15.3</td>
      <td>17.1</td>
      <td>17.1</td>
      <td>14.7</td>
      <td>10.4</td>
      <td>6.1</td>
      <td>3.5</td>
      <td>50.38</td>
      <td>3.04</td>
      <td>9.73</td>
      <td>14.7</td>
      <td>NE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Janv</th>
      <th>Févr</th>
      <th>Mars</th>
      <th>Avri</th>
      <th>Mai</th>
      <th>Juin</th>
      <th>juil</th>
      <th>Août</th>
      <th>Sept</th>
      <th>Octo</th>
      <th>Nove</th>
      <th>Déce</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Moye</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Paris</th>
      <td>3.4</td>
      <td>4.1</td>
      <td>7.6</td>
      <td>10.7</td>
      <td>14.3</td>
      <td>17.5</td>
      <td>19.1</td>
      <td>18.7</td>
      <td>16.0</td>
      <td>11.4</td>
      <td>7.1</td>
      <td>4.3</td>
      <td>48.52</td>
      <td>2.20</td>
      <td>11.18</td>
      <td>15.7</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="index">
<h2>Index<a class="headerlink" href="#index" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Bordeaux&#39;, &#39;Brest&#39;, &#39;Clermont&#39;, &#39;Grenoble&#39;, &#39;Lille&#39;, &#39;Lyon&#39;,
       &#39;Marseille&#39;, &#39;Montpellier&#39;, &#39;Nantes&#39;, &#39;Nice&#39;, &#39;Paris&#39;, &#39;Rennes&#39;,
       &#39;Strasbourg&#39;, &#39;Toulouse&#39;, &#39;Vichy&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can rename an index by setting its name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;City&quot;</span>
<span class="n">french_cities</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Janv</th>
      <th>Févr</th>
      <th>Mars</th>
      <th>Avri</th>
      <th>Mai</th>
      <th>Juin</th>
      <th>juil</th>
      <th>Août</th>
      <th>Sept</th>
      <th>Octo</th>
      <th>Nove</th>
      <th>Déce</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Moye</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Lille</th>
      <td>2.4</td>
      <td>2.9</td>
      <td>6.0</td>
      <td>8.9</td>
      <td>12.4</td>
      <td>15.3</td>
      <td>17.1</td>
      <td>17.1</td>
      <td>14.7</td>
      <td>10.4</td>
      <td>6.1</td>
      <td>3.5</td>
      <td>50.38</td>
      <td>3.04</td>
      <td>9.73</td>
      <td>14.7</td>
      <td>NE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">calendar</span>
 
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
 
<span class="n">months</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span>
<span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">months</span><span class="p">)</span>
 
<span class="n">french_cities</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
  <span class="n">columns</span><span class="o">=</span><span class="p">{</span> <span class="n">old</span> <span class="p">:</span> <span class="n">new</span> 
           <span class="k">for</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">french_cities</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">12</span><span class="p">],</span> <span class="n">months</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
          <span class="k">if</span> <span class="n">old</span> <span class="o">!=</span> <span class="n">new</span> <span class="p">},</span>
  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 
<span class="n">french_cities</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Moye&#39;</span><span class="p">:</span><span class="s1">&#39;Mean&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
<div class="section" id="exercise-rename-dataframe-months-in-english">
<h3>Exercise: Rename DataFrame Months in English<a class="headerlink" href="#exercise-rename-dataframe-months-in-english" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="from-a-local-or-remote-html-file">
<h2>From a local or remote HTML file<a class="headerlink" href="#from-a-local-or-remote-html-file" title="Permalink to this headline">¶</a></h2>
<p>We can download and extract data about mean sea level stations around the world from the <a class="reference external" href="http://www.psmsl.org/">PSMSL website</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Needs `lxml`, `beautifulSoup4` and `html5lib` python packages</span>
<span class="n">table_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s2">&quot;http://www.psmsl.org/data/obtaining/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># there is 1 table on that page which contains metadata about the stations where </span>
<span class="c1"># sea levels are recorded</span>
<span class="n">local_sea_level_stations</span> <span class="o">=</span> <span class="n">table_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">local_sea_level_stations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Station Name</th>
      <th>ID</th>
      <th>Lat.</th>
      <th>Lon.</th>
      <th>GLOSS ID</th>
      <th>Country</th>
      <th>Date</th>
      <th>Coastline</th>
      <th>Station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BREST</td>
      <td>1</td>
      <td>48.383</td>
      <td>-4.495</td>
      <td>242.0</td>
      <td>FRA</td>
      <td>07/08/2019</td>
      <td>190</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SWINOUJSCIE</td>
      <td>2</td>
      <td>53.917</td>
      <td>14.233</td>
      <td>NaN</td>
      <td>POL</td>
      <td>19/10/2001</td>
      <td>110</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SHEERNESS</td>
      <td>3</td>
      <td>51.446</td>
      <td>0.743</td>
      <td>NaN</td>
      <td>GBR</td>
      <td>06/06/2019</td>
      <td>170</td>
      <td>101</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HOLYHEAD</td>
      <td>5</td>
      <td>53.314</td>
      <td>-4.620</td>
      <td>NaN</td>
      <td>GBR</td>
      <td>13/08/2020</td>
      <td>170</td>
      <td>191</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1544</th>
      <td>SUVA-B</td>
      <td>2356</td>
      <td>-18.133</td>
      <td>178.428</td>
      <td>NaN</td>
      <td>FJI</td>
      <td>28/01/2020</td>
      <td>742</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1545</th>
      <td>SYDNEY PORT JACKSON</td>
      <td>2358</td>
      <td>-33.826</td>
      <td>151.259</td>
      <td>NaN</td>
      <td>AUS</td>
      <td>13/06/2019</td>
      <td>680</td>
      <td>138</td>
    </tr>
    <tr>
      <th>1546</th>
      <td>ARKO</td>
      <td>2359</td>
      <td>58.484</td>
      <td>16.961</td>
      <td>NaN</td>
      <td>SWE</td>
      <td>25/08/2020</td>
      <td>50</td>
      <td>112</td>
    </tr>
    <tr>
      <th>1547</th>
      <td>UDDEVALLA</td>
      <td>2360</td>
      <td>58.348</td>
      <td>11.895</td>
      <td>NaN</td>
      <td>SWE</td>
      <td>25/08/2020</td>
      <td>50</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
<p>1548 rows × 9 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="indexing-on-dataframes">
<h2>Indexing on DataFrames<a class="headerlink" href="#indexing-on-dataframes" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Lati&#39;</span><span class="p">]</span>  <span class="c1"># DF [] accesses columns (Series)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Bordeaux      44.50
Brest         48.24
Clermont      45.47
Grenoble      45.10
              ...  
Rennes        48.05
Strasbourg    48.35
Toulouse      43.36
Vichy         46.08
Name: Lati, Length: 15, dtype: float64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> allow to access individual values, slices or masked selections:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Rennes&#39;</span><span class="p">,</span> <span class="s2">&quot;Sep&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Rennes&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Sep&quot;</span><span class="p">,</span> <span class="s2">&quot;Dec&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sep    15.7
Dec     5.4
Name: Rennes, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Rennes&#39;</span><span class="p">,</span> <span class="s2">&quot;Sep&quot;</span><span class="p">:</span><span class="s2">&quot;Dec&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sep    15.7
Oct    11.6
Nov     7.8
Dec     5.4
Name: Rennes, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="masking">
<h2>Masking<a class="headerlink" href="#masking" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">french_cities</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            Jan   Mar   May   Jul   Sep  Nov
City                                        
Bordeaux    5.6  10.3  15.8  20.9  18.6  9.1
Brest       6.1   7.8  11.6  15.6  14.7  9.0
Clermont    2.6   7.5  13.8  19.4  16.2  6.6
Grenoble    1.5   7.7  14.5  20.1  16.7  6.5
...         ...   ...   ...   ...   ...  ...
Rennes      4.8   7.9  13.1  17.9  15.7  7.8
Strasbourg  0.4   5.6  14.0  19.0  15.1  4.9
Toulouse    4.7   9.2  14.9  20.9  18.3  8.6
Vichy       2.4   7.1  13.6  19.3  16.0  6.6

[15 rows x 6 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">french_cities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Rennes&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jan     4.8
Mar     7.9
May    13.1
Jul    17.9
Sep    15.7
Nov     7.8
Name: Rennes, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="new-column">
<h2>New column<a class="headerlink" href="#new-column" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
      <th>std</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
      <td>5.792681</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
      <td>3.773673</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
      <td>6.189795</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
      <td>6.770771</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
      <td>4.958800</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
      <td>6.931723</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
      <td>6.056977</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
      <td>6.201148</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># remove this new column</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="modifying-a-dataframe-with-multiple-indexing">
<h2>Modifying a dataframe with multiple indexing<a class="headerlink" href="#modifying-a-dataframe-with-multiple-indexing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># french_cities[&#39;Rennes&#39;][&#39;Sep&#39;] = 25 # It does not works and breaks the DataFrame</span>
<span class="n">french_cities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Rennes&#39;</span><span class="p">][</span><span class="s1">&#39;Sep&#39;</span><span class="p">]</span> <span class="c1"># = 25 is the right way to do it</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bordeaux</th>
      <td>5.6</td>
      <td>6.6</td>
      <td>10.3</td>
      <td>12.8</td>
      <td>15.8</td>
      <td>19.3</td>
      <td>20.9</td>
      <td>21.0</td>
      <td>18.6</td>
      <td>13.8</td>
      <td>9.1</td>
      <td>6.2</td>
      <td>44.50</td>
      <td>-0.34</td>
      <td>13.33</td>
      <td>15.4</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Clermont</th>
      <td>2.6</td>
      <td>3.7</td>
      <td>7.5</td>
      <td>10.3</td>
      <td>13.8</td>
      <td>17.3</td>
      <td>19.4</td>
      <td>19.1</td>
      <td>16.2</td>
      <td>11.2</td>
      <td>6.6</td>
      <td>3.6</td>
      <td>45.47</td>
      <td>3.05</td>
      <td>10.94</td>
      <td>16.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Grenoble</th>
      <td>1.5</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>10.6</td>
      <td>14.5</td>
      <td>17.8</td>
      <td>20.1</td>
      <td>19.5</td>
      <td>16.7</td>
      <td>11.4</td>
      <td>6.5</td>
      <td>2.3</td>
      <td>45.10</td>
      <td>5.43</td>
      <td>10.98</td>
      <td>18.6</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Rennes</th>
      <td>4.8</td>
      <td>5.3</td>
      <td>7.9</td>
      <td>10.1</td>
      <td>13.1</td>
      <td>16.2</td>
      <td>17.9</td>
      <td>17.8</td>
      <td>15.7</td>
      <td>11.6</td>
      <td>7.8</td>
      <td>5.4</td>
      <td>48.05</td>
      <td>-1.41</td>
      <td>11.13</td>
      <td>13.1</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Vichy</th>
      <td>2.4</td>
      <td>3.4</td>
      <td>7.1</td>
      <td>9.9</td>
      <td>13.6</td>
      <td>17.1</td>
      <td>19.3</td>
      <td>18.8</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>6.6</td>
      <td>3.4</td>
      <td>46.08</td>
      <td>3.26</td>
      <td>10.72</td>
      <td>16.9</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="transforming-datasets">
<h2>Transforming datasets<a class="headerlink" href="#transforming-datasets" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Ampl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9.72, 18.6)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="apply">
<h2>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h2>
<p>Let’s convert the temperature mean from Celsius to Fahrenheit degree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fahrenheit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">T</span><span class="p">:</span> <span class="n">T</span><span class="o">*</span><span class="mi">9</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="mi">32</span>
<span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>City
Bordeaux      55.994
Brest         51.386
Clermont      51.692
Grenoble      51.764
               ...  
Rennes        52.034
Strasbourg    49.496
Toulouse      54.824
Vichy         51.296
Name: Mean, Length: 15, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sort">
<h2>Sort<a class="headerlink" href="#sort" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Lati&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Marseille</th>
      <td>5.5</td>
      <td>6.6</td>
      <td>10.0</td>
      <td>13.0</td>
      <td>16.8</td>
      <td>20.8</td>
      <td>23.3</td>
      <td>22.8</td>
      <td>19.9</td>
      <td>15.0</td>
      <td>10.2</td>
      <td>6.9</td>
      <td>43.18</td>
      <td>5.24</td>
      <td>14.23</td>
      <td>17.8</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Montpellier</th>
      <td>5.6</td>
      <td>6.7</td>
      <td>9.9</td>
      <td>12.8</td>
      <td>16.2</td>
      <td>20.1</td>
      <td>22.7</td>
      <td>22.3</td>
      <td>19.3</td>
      <td>14.6</td>
      <td>10.0</td>
      <td>6.5</td>
      <td>43.36</td>
      <td>3.53</td>
      <td>13.89</td>
      <td>17.1</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Nice</th>
      <td>7.5</td>
      <td>8.5</td>
      <td>10.8</td>
      <td>13.3</td>
      <td>16.7</td>
      <td>20.1</td>
      <td>22.7</td>
      <td>22.5</td>
      <td>20.3</td>
      <td>16.0</td>
      <td>11.5</td>
      <td>8.2</td>
      <td>43.42</td>
      <td>7.15</td>
      <td>14.84</td>
      <td>15.2</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Paris</th>
      <td>3.4</td>
      <td>4.1</td>
      <td>7.6</td>
      <td>10.7</td>
      <td>14.3</td>
      <td>17.5</td>
      <td>19.1</td>
      <td>18.7</td>
      <td>16.0</td>
      <td>11.4</td>
      <td>7.1</td>
      <td>4.3</td>
      <td>48.52</td>
      <td>2.20</td>
      <td>11.18</td>
      <td>15.7</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Lille</th>
      <td>2.4</td>
      <td>2.9</td>
      <td>6.0</td>
      <td>8.9</td>
      <td>12.4</td>
      <td>15.3</td>
      <td>17.1</td>
      <td>17.1</td>
      <td>14.7</td>
      <td>10.4</td>
      <td>6.1</td>
      <td>3.5</td>
      <td>50.38</td>
      <td>3.04</td>
      <td>9.73</td>
      <td>14.7</td>
      <td>NE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Lati&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">french_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Lati</th>
      <th>Long</th>
      <th>Mean</th>
      <th>Ampl</th>
      <th>Région</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lille</th>
      <td>2.4</td>
      <td>2.9</td>
      <td>6.0</td>
      <td>8.9</td>
      <td>12.4</td>
      <td>15.3</td>
      <td>17.1</td>
      <td>17.1</td>
      <td>14.7</td>
      <td>10.4</td>
      <td>6.1</td>
      <td>3.5</td>
      <td>50.38</td>
      <td>3.04</td>
      <td>9.73</td>
      <td>14.7</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Paris</th>
      <td>3.4</td>
      <td>4.1</td>
      <td>7.6</td>
      <td>10.7</td>
      <td>14.3</td>
      <td>17.5</td>
      <td>19.1</td>
      <td>18.7</td>
      <td>16.0</td>
      <td>11.4</td>
      <td>7.1</td>
      <td>4.3</td>
      <td>48.52</td>
      <td>2.20</td>
      <td>11.18</td>
      <td>15.7</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Strasbourg</th>
      <td>0.4</td>
      <td>1.5</td>
      <td>5.6</td>
      <td>9.8</td>
      <td>14.0</td>
      <td>17.2</td>
      <td>19.0</td>
      <td>18.3</td>
      <td>15.1</td>
      <td>9.5</td>
      <td>4.9</td>
      <td>1.3</td>
      <td>48.35</td>
      <td>7.45</td>
      <td>9.72</td>
      <td>18.6</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>Brest</th>
      <td>6.1</td>
      <td>5.8</td>
      <td>7.8</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.4</td>
      <td>15.6</td>
      <td>16.0</td>
      <td>14.7</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>48.24</td>
      <td>-4.29</td>
      <td>10.77</td>
      <td>10.2</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Nice</th>
      <td>7.5</td>
      <td>8.5</td>
      <td>10.8</td>
      <td>13.3</td>
      <td>16.7</td>
      <td>20.1</td>
      <td>22.7</td>
      <td>22.5</td>
      <td>20.3</td>
      <td>16.0</td>
      <td>11.5</td>
      <td>8.2</td>
      <td>43.42</td>
      <td>7.15</td>
      <td>14.84</td>
      <td>15.2</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Montpellier</th>
      <td>5.6</td>
      <td>6.7</td>
      <td>9.9</td>
      <td>12.8</td>
      <td>16.2</td>
      <td>20.1</td>
      <td>22.7</td>
      <td>22.3</td>
      <td>19.3</td>
      <td>14.6</td>
      <td>10.0</td>
      <td>6.5</td>
      <td>43.36</td>
      <td>3.53</td>
      <td>13.89</td>
      <td>17.1</td>
      <td>SE</td>
    </tr>
    <tr>
      <th>Toulouse</th>
      <td>4.7</td>
      <td>5.6</td>
      <td>9.2</td>
      <td>11.6</td>
      <td>14.9</td>
      <td>18.7</td>
      <td>20.9</td>
      <td>20.9</td>
      <td>18.3</td>
      <td>13.3</td>
      <td>8.6</td>
      <td>5.5</td>
      <td>43.36</td>
      <td>1.26</td>
      <td>12.68</td>
      <td>16.2</td>
      <td>SO</td>
    </tr>
    <tr>
      <th>Marseille</th>
      <td>5.5</td>
      <td>6.6</td>
      <td>10.0</td>
      <td>13.0</td>
      <td>16.8</td>
      <td>20.8</td>
      <td>23.3</td>
      <td>22.8</td>
      <td>19.9</td>
      <td>15.0</td>
      <td>10.2</td>
      <td>6.9</td>
      <td>43.18</td>
      <td>5.24</td>
      <td>14.23</td>
      <td>17.8</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="stack-and-unstack">
<h2>Stack and unstack<a class="headerlink" href="#stack-and-unstack" title="Permalink to this headline">¶</a></h2>
<p>Instead of seeing the months along the axis 1, and the cities along the axis 0, let’s try to convert these into an outer and an inner axis along only 1 time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">unstacked</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">unstacked</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     City       
Jan  Lille          2.4
     Paris          3.4
     Strasbourg     0.4
     Brest          6.1
     Rennes         4.8
                   ... 
Dec  Bordeaux       6.2
     Nice           8.2
     Montpellier    6.5
     Toulouse       5.5
     Marseille      6.9
Length: 180, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">unstacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transpose">
<h2>Transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h2>
<p>The result is grouped in the wrong order since it sorts first the axis that was unstacked. We need to transpose the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">city_temp</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">city_temp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/venv/lib/python3.7/site-packages/pandas/plotting/_matplotlib/core.py:1192: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax.set_xticklabels(xticklabels)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/11-PandaDataframes_47_2.png" src="_images/11-PandaDataframes_47_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">city_temp</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/11-PandaDataframes_48_0.png" src="_images/11-PandaDataframes_48_0.png" />
</div>
</div>
</div>
<div class="section" id="describing">
<h2>Describing<a class="headerlink" href="#describing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Région&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     15
unique     4
top       SE
freq       7
Name: Région, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Région&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;NE&#39;, &#39;NO&#39;, &#39;SE&#39;, &#39;SO&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="p">[</span><span class="s1">&#39;Région&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SE    7
NE    3
NO    3
SO    2
Name: Région, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># To save memory, we can convert it to a categorical column:</span>
<span class="n">french_cities</span><span class="p">[</span><span class="s2">&quot;Région&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">french_cities</span><span class="p">[</span><span class="s2">&quot;Région&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">french_cities</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index     760
Jan       120
Feb       120
Mar       120
Apr       120
May       120
Jun       120
Jul       120
Aug       120
Sep       120
Oct       120
Nov       120
Dec       120
Lati      120
Long      120
Mean      120
Ampl      120
Région    207
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-aggregation-summarization">
<h2>Data Aggregation/summarization<a class="headerlink" href="#data-aggregation-summarization" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="groupby">
<h2>groupby<a class="headerlink" href="#groupby" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fc_grouped_region</span> <span class="o">=</span> <span class="n">french_cities</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Région&quot;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">fc_grouped_region</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.groupby.generic.DataFrameGroupBy
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">subdf</span> <span class="ow">in</span> <span class="n">fc_grouped_region</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subdf</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NE
            Jan  Feb  Mar   Apr   May   Jun   Jul   Aug   Sep   Oct  Nov  Dec  \
City                                                                            
Lille       2.4  2.9  6.0   8.9  12.4  15.3  17.1  17.1  14.7  10.4  6.1  3.5   
Paris       3.4  4.1  7.6  10.7  14.3  17.5  19.1  18.7  16.0  11.4  7.1  4.3   
Strasbourg  0.4  1.5  5.6   9.8  14.0  17.2  19.0  18.3  15.1   9.5  4.9  1.3   

             Lati  Long   Mean  Ampl Région  
City                                         
Lille       50.38  3.04   9.73  14.7     NE  
Paris       48.52  2.20  11.18  15.7     NE  
Strasbourg  48.35  7.45   9.72  18.6     NE  

NO
        Jan  Feb  Mar   Apr   May   Jun   Jul   Aug   Sep   Oct  Nov  Dec  \
City                                                                        
Brest   6.1  5.8  7.8   9.2  11.6  14.4  15.6  16.0  14.7  12.0  9.0  7.0   
Rennes  4.8  5.3  7.9  10.1  13.1  16.2  17.9  17.8  15.7  11.6  7.8  5.4   
Nantes  5.0  5.3  8.4  10.8  13.9  17.2  18.8  18.6  16.4  12.2  8.2  5.5   

         Lati  Long   Mean  Ampl Région  
City                                     
Brest   48.24 -4.29  10.77  10.2     NO  
Rennes  48.05 -1.41  11.13  13.1     NO  
Nantes  47.13 -1.33  11.69  13.8     NO  

SE
             Jan  Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov  \
City                                                                          
Vichy        2.4  3.4   7.1   9.9  13.6  17.1  19.3  18.8  16.0  11.0   6.6   
Clermont     2.6  3.7   7.5  10.3  13.8  17.3  19.4  19.1  16.2  11.2   6.6   
Lyon         2.1  3.3   7.7  10.9  14.9  18.5  20.7  20.1  16.9  11.4   6.7   
Grenoble     1.5  3.2   7.7  10.6  14.5  17.8  20.1  19.5  16.7  11.4   6.5   
Nice         7.5  8.5  10.8  13.3  16.7  20.1  22.7  22.5  20.3  16.0  11.5   
Montpellier  5.6  6.7   9.9  12.8  16.2  20.1  22.7  22.3  19.3  14.6  10.0   
Marseille    5.5  6.6  10.0  13.0  16.8  20.8  23.3  22.8  19.9  15.0  10.2   

             Dec   Lati  Long   Mean  Ampl Région  
City                                               
Vichy        3.4  46.08  3.26  10.72  16.9     SE  
Clermont     3.6  45.47  3.05  10.94  16.8     SE  
Lyon         3.1  45.45  4.51  11.36  18.6     SE  
Grenoble     2.3  45.10  5.43  10.98  18.6     SE  
Nice         8.2  43.42  7.15  14.84  15.2     SE  
Montpellier  6.5  43.36  3.53  13.89  17.1     SE  
Marseille    6.9  43.18  5.24  14.23  17.8     SE  

SO
          Jan  Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct  Nov  Dec  \
City                                                                           
Bordeaux  5.6  6.6  10.3  12.8  15.8  19.3  20.9  21.0  18.6  13.8  9.1  6.2   
Toulouse  4.7  5.6   9.2  11.6  14.9  18.7  20.9  20.9  18.3  13.3  8.6  5.5   

           Lati  Long   Mean  Ampl Région  
City                                       
Bordeaux  44.50 -0.34  13.33  15.4     SO  
Toulouse  43.36  1.26  12.68  16.2     SO  
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<p>Consider the following dataset <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant">UCI Machine Learning Repository Combined Cycle Power Plant Data Set</a>.
This dataset consists of records of measurements relating to peaker power plants of 10000 points over 6 years (2006-2011).</p>
<p><strong>Variables</strong></p>
<ul class="simple">
<li><p>AT = Atmospheric Temperature in C</p></li>
<li><p>V = Exhaust Vaccum Speed</p></li>
<li><p>AP = Atmospheric Pressure</p></li>
<li><p>RH = Relative Humidity</p></li>
<li><p>PE = Power Output</p></li>
</ul>
<p>We want to model the power output as a function of the other parameters.</p>
<p>Observations are in 5 excel sheets of about 10000 records in “Folds5x2_pp.xlsx”. These 5 sheets are same data shuffled.</p>
<ul class="simple">
<li><p>Read this file with the pandas function <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html">read_excel</a>. What is the type returned by this function?</p></li>
<li><p>Implement a <code class="docutils literal notranslate"><span class="pre">select</span></code> function to regroup all observations in a pandas serie.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">select</span></code> function and <code class="docutils literal notranslate"><span class="pre">corr</span></code> to compute the maximum correlation.</p></li>
<li><p>Parallelize this loop with <code class="docutils literal notranslate"><span class="pre">concurrent.futures</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/Folds5x2_pp.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;AT&#39;, &#39;V&#39;, &#39;AP&#39;, &#39;RH&#39;, &#39;PE&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AT&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       14.96
1       25.18
2        5.11
3       20.86
4       10.82
        ...  
9563    16.65
9564    13.19
9565    31.32
9566    24.48
9567    21.60
Name: AT, Length: 9568, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
 
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
 
<span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">corr</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> matches with </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> with correlation </span><span class="si">{</span><span class="n">corr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PE matches with AT with correlation 0.9481284704167594
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
 
<span class="n">e</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 
<span class="n">futures</span> <span class="o">=</span> <span class="p">{}</span>
 
<span class="k">def</span> <span class="nf">corr</span><span class="p">(</span> <span class="n">serie_a</span><span class="p">,</span> <span class="n">serie_b</span><span class="p">):</span>
 
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">serie_a</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">serie_b</span><span class="p">))</span>
 
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">futures</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span> <span class="n">corr</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
 
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
 
 
<span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">corr</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;PE&#39;, &#39;AT&#39;, 0.9481284704167594)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "pnavaro/big-data",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "big-data"
        },
        kernelOptions: {
            kernelName: "big-data",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'big-data'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="10-PandasSeries.html" title="previous page">Pandas Series</a>
    <a class='right-next' id="next-link" href="12-UnixCommands.html" title="next page">Basic Commands in the Unix Shell</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Pierre Navaro<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>